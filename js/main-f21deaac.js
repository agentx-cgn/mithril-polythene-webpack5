(self.webpackChunk=self.webpackChunk||[]).push([[179],{558:(e,t,n)=>{var a=n(174),s=n.n(a);const r={deepassign:n(857).all,deepcopy:e=>JSON.parse(JSON.stringify(e)),deepclean(e){for(let t of Object.getOwnPropertyNames(e)){const n=e[t];"object"==typeof n&&r.deepclean(n)}return Object.setPrototypeOf(e,null),e},range(e,t,n){var a,s=[],r=arguments.length;if(0===r)return s;for(1===r&&(t=e,e=0,n=1),2===r&&(n=1),a=e;a<t;a+=n)s.push(a);return s},clone(...e){const t=r.deepassign([{},...e]),n=r.deepcopy(t);return r.deepclean(n),n},clean:e=>(Object.setPrototypeOf(e,null),e),clear:e=>(Object.keys(e).forEach((t=>delete e[t])),e),create(...e){const t=e.length?Object.assign.apply(null,[{},...e]):{};return Object.setPrototypeOf(t,null),t},deepFreezeCreate(...e){const t=e.length?Object.assign.apply(null,[{},...e]):{},n=Object.getOwnPropertyNames(t);for(let e of n){const n=t[e];n&&"object"==typeof n&&(Object.setPrototypeOf(n,null),Object.freeze(n))}return Object.setPrototypeOf(t,null),Object.freeze(t),t},transform(e,t){const n=r.create();return Object.keys(e).forEach((a=>{n[a]=t(a,e[a])})),n},strip(e){const t=r.create(e);return Object.entries(t).forEach((e=>{const[n]=e;void 0===t[n]&&delete t[n]})),t},shrink:e=>JSON.stringify(r.strip(e)).replace(/"/g,"").slice(0,140),eat:e=>(e.preventDefault(),e.stopPropagation(),!1),msecs2human(e){function t(e){return e>1?"s":""}let n=Math.floor(e/1e3);const a=Math.floor(n/31536e3);if(a)return a+" year"+t(a);const s=Math.floor((n%=31536e3)/86400);if(s)return s+" day"+t(s);const r=Math.floor((n%=86400)/3600);if(r)return r+" hour"+t(r);const o=Math.floor((n%=3600)/60);if(o)return o+" minute"+t(o);const i=n%60;return i?i+" second"+t(i):"less than a second"}},o=document.querySelector.bind(document),i=JSON.parse('{"name":"mithril-webpack-5","version":"0.1.1","description":"an opinionated mithril polythene webpack seed project","keywords":["mithril","webpack","seed"],"homepage":"https://agentx-cgn.github.io/mithril-polythene-webpack5/","bugs":{"url":"https://github.com/agentx-cgn/mithril-polythene-webpack5/issues"},"repository":{"type":"git","url":"https://github.com/agentx-cgn/mithril-polythene-webpack5"},"author":"agentx-cgn","license":"MIT","main":"index.ts","type":"module","private":true,"scripts":{"start":"cross-env NODE_ENV=development webpack-dev-server --config ./config/webpack/webpack.config.js","build":"cross-env NODE_ENV=production  webpack --progress --config ./config/webpack/webpack.config.js","publish":"npm run build && rm -rf ./docs/* && cp -r ./dist/* ./docs && git add . && git commit -m \'update pages\' && git push","chk:lint":"eslint src/**/*.ts","chk:tsc":"npx tsc --project tsconfig.json --noEmit","chk:circ":"madge --warning --circular  --ts-config ./tsconfig.json  --extensions ts ./src"},"dependencies":{"deepmerge":"^4.2.2","local-storage":"^2.0.0","mithril":"^2.2.2","polythene-css":"^1.7.5","polythene-mithril":"^1.7.5","screenfull":"^6.0.1"},"devDependencies":{"@types/mithril":"^2.0.11","@typescript-eslint/eslint-plugin":"^5.26.0","@typescript-eslint/parser":"^5.26.0","@typescript/lib-dom":"npm:@types/web@^0.0.67","copy-webpack-plugin":"^11.0.0","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.16.0","file-loader":"^6.2.0","gh-pages":"^4.0.0","html-loader":"^3.1.0","html-webpack-plugin":"^5.5.0","mini-css-extract-plugin":"^2.6.0","sass":"^1.52.1","sass-loader":"^13.0.0","style-loader":"^3.3.1","tachyons":"^4.12.0","ts-loader":"^9.3.0","typescript":"^4.7.3","webpack":"^5.72.1","webpack-cli":"^4.9.2","webpack-dev-server":"^4.9.0","webpack-merge":"^5.8.0"}}'),l={timecontrol:{budget:0,bonus:0},white:{budget:0,consumed:0,pressure:!1},black:{budget:0,consumed:0,pressure:!1}},c={uuid:"G0000000",over:!0,rivals:"h-h",turn:-1,moves:[],score:{maxcp:0,maxmate:0},header:{White:"White",Black:"Black",Event:"",Site:"caissa.js.org",Round:"",Date:"",Result:"",Termination:"",TimeControl:""},pgn:""},d=Object.assign({},c,{over:!1,clock:l}),p={uuid:"B0000000",fen:"",moveStart:"",bestmove:{move:{from:"",to:""},ponder:{from:"",to:""}},captured:{white:[],black:[]},orientation:"w",buttons:{rotate:!0,backward:!0,forward:!0,left:!0,right:!0,play:!1,pause:!1,evaluate:!0}},u={isProduction:!0,isDevelopment:!1,version:i.version,appname:i.name,description:i.description,homepage:i.homepage,fens:{empty:"8/8/8/8/8/8/8/8 w - - 0 1",start:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"},opponents:{h:"Human",l:"Leela",s:"Stockfish"},database:{updateInterval:6e4},templates:{clock:l,move:{turn:-1,fen:"",from:"",to:"",color:"",piece:"",san:""},game:c,play:d,board:p,default:Object.assign({},c,{uuid:"default",over:!1,turn:-1,rivals:"x-x",subline:"no pressure",header:{White:"White",Black:"Black"}}),plays:[{rivals:"x-x",over:!1,subline:"no pressure",header:{White:"White",Black:"Black"}},{rivals:"s-s",over:!1,subline:"this is fun",header:{White:"Stockfish",Black:"Stockfish"}},{rivals:"h-s",over:!1,subline:"beat the machine",header:{White:"Human",Black:"Stockfish"}},{rivals:"s-h",over:!1,subline:"beat the machine",header:{White:"Stockfish",Black:"Human"}}]},tableTemplates:{Games:c,Boards:p},pieces:{fens:{white:"PPPPPPPPRNBQKBNR",black:"pppppppprnbqkbnr",sorted:"kqrbnp"},font:{k:"l",q:"w",r:"t",b:"n",n:"j",p:"o",K:"l",Q:"w",R:"t",B:"n",N:"j",P:"o"},value:{k:0,q:9,r:5,b:3,n:3,p:1,K:0,Q:9,R:5,B:3,N:3,P:1}},apis:[{idx:1,caption:"api.chess.com/pub/player/",value:"https://api.chess.com/pub/player/noiv/games/2020/04/pgn"},{idx:2,caption:"lichess.org/api/games/user",value:"http://localhost:3000/static/games.pgn"},{idx:3,caption:"localhost:3000/static/games.few.pgn",value:"http://localhost:3000/static/games.few.pgn"},{idx:4,caption:"localhost:3000/static/games.pgn",value:"http://localhost:3000/static/games.pgn"}],openings:[{idx:1,caption:"OP01",value:"OP01"},{idx:2,caption:"OP02",value:"OP02"},{idx:3,caption:"OP03",value:"OP03"}],timecontrols:[{idx:0,caption:"10 secs + 0",budget:1e4,bonus:0},{idx:1,caption:" 1 min  + 0",budget:6e4,bonus:0},{idx:2,caption:" 5 min  + 0",budget:3e5,bonus:0},{idx:3,caption:"10 min  + 0",budget:6e5,bonus:0}],plays:{difficulties:{0:"looser",3:"rooky",5:"beginner",10:"experienced",20:"hardcore",30:"no chance"}},board:{config:{position:"empty",style:{cssClass:"gray",showCoordinates:!1,showBorder:!1},sprite:{grid:40,markers:["marker4","marker5","selectedmoves","selectednomoves"]},responsive:!0,animationDuration:300}},flagTitles:{n:"a non-capture",b:"a pawn push of two squares",e:"an en passant capture",c:"a standard capture",p:"a promotion",k:"kingside castling",q:"queenside castling",pc:"capture + promotion"},flagColors:{w:{n:"#fff",b:"darkgreen",e:"darkgreen",c:"darkred",p:"red",k:"darkgreen",q:"darkgreen",pc:"orange"},b:{n:"#333",b:"darkgreen",e:"darkred",c:"darkred",p:"red",k:"darkgreen",q:"darkgreen",pc:"orange"}}},m=[["/system/:module/","SYSTEM",{module:"system"},{ifa:"fa-microchip",subline:"This is hidden in production"}],["/preferences/","PREFERENCES",{},{ifa:"fa-cogs",subline:"Custumize Caissa to your needs"}],["/nothing/","NOTHING",{},{ifa:"fa-cogs",subline:"Just a dummy page"}],["/help/","HELP",{},{ifa:"fa-cogs",subline:"You need it"}],["/404/","404",{},{img:n.p+"assets/images/chess.128.trans.png",subline:"Break it"}]],g={uuid:"0",user:{name:"anonymous"},"play-h-s":{depth:1,timecontrol:{idx:0,caption:"10 secs",budget:1e4,bonus:0},opening:{idx:1,label:"OP01"}},"play-s-h":{depth:2,timecontrol:{idx:0,caption:"10 secs",budget:1e4,bonus:0},opening:{idx:2,label:"OP02"}},"play-s-s":{depth:3,timecontrol:{idx:0,caption:"10 secs",budget:1e4,bonus:0},opening:{idx:3,label:"OP03"}},"game-evaluator":{engine:"stockfish",maxthreads:2,maxdepth:5,maxsecs:1,divisor:2},"board-illustrations":{attack:!1,heatmap:!0,lastmove:!0,bestmove:!0,availmoves:!0,validmoves:!0,pinning:!0,test:!1},ui:{waitscreen:!0},"game-panel-toggles":{moves:"show",illus:"show",ecos:"show"},chessclock:{divisor:{small:1,big:5},pressure:1e4}},f=[],h={create(e,t){let n=!1;var a;"function"==typeof t.onregister&&t.onregister((a=e,{send(e){f.forEach((t=>{"function"==typeof t.onmessage&&a!==t.name&&t.onmessage(a,e)}))}}));const s=Object.assign({name:e,onbeforeupdate:()=>!0,get preventUpdates(){return n},set preventUpdates(e){n=e}},t);return f.push(s),()=>s}},v={engine:"ENGI",stockfish:"FISH",analyzer:"ANLY",logger:"LOGG",dispatcher:"DISP",games:"GAMS",evalgame:"NEWG",events:"EVTS",caissa:"CAIS"};let b=[];function w(e,t){b.unshift((new Date).toLocaleTimeString()+" "+(v[e]||"----")+" - "+function(e){return e.replace(/infinite/g,'<strong class="dark-blue">infinite</strong>').replace(/readyok/g,'<strong class="dark-green">readyok</strong>').replace(/uciok/g,'<strong class="dark-green">uciok</strong>').replace(/bestmove/g,'<strong class="dark-blue">bestmove</strong>').replace(/ponder/g,'<strong class="dark-blue">ponder</strong>').replace(/-r>/g,'<strong class="dark-red">==></strong>').replace(/-g>/g,'<strong class="dark-green">==></strong>')}(t))}w("logger","init: "+(new Date).toLocaleDateString()),w("logger","init: "+(new Date).toLocaleTimeString());const y={log:w,shrink:function(e){return JSON.stringify(e).replace(/"/g,"").slice(0,140)},search:e=>e.length>2?b.filter((t=>t.includes(e))):b};var k=n(427);const x={Usage:[{uuid:"0",laststart:Date.now(),lastend:Date.now(),usage:0}],Options:[r.clone(g)],Boards:[r.clone(u.templates.board,{uuid:"default"})],Games:[r.clone(u.templates.default)]},N={Usage:{uuid:"0",laststart:Date.now(),lastend:Date.now(),usage:0},Options:r.clone({}),Boards:r.clone({}),Games:r.clone({})},O=function(e){const t=x[e],n=N[e];let a,s,o,i=!0,l=k.get(e);function c(){o=window.setInterval((()=>{i&&a.persist(!0)}),u.database.updateInterval||6e4)}return l?(s=l,console.log("TAB."+e,"loaded",s)):(k.set(e,t),s=t,console.log("TAB."+e,"initialized",s)),c(),a=r.clean({dump(){console.log(JSON.stringify(k.get(e),null,2))},toggleUpdates(){o?clearInterval(o):c()},get length(){return s.length},get list(){return s},get first(){return s[0]||void 0},exists:e=>!!s.find((t=>t.uuid===e)),find:e=>s.find((t=>t.uuid===e))||void 0,filter:e=>s.filter(e),clear(n=!0){const r=s.length;s=t,a.persist(n),console.log("TAB."+e,"cleared, with",r,"rows")},create:(t,n=!1)=>(s.push(t),a.persist(n),console.log("TAB."+e,"created",t.uuid,n),t),createget(t,o={},i=!1){let l=a.find(t);return void 0===l&&(l=r.clone(n,o),l.uuid=t,s.push(l),a.persist(i)),console.log("TAB."+e,"createget",t,r.shrink(l)),l},delete(t,n=!0){if("function"==typeof t)a.filter(t).forEach((e=>{a.delete(e.uuid,!1)})),a.persist(n);else if("string"==typeof t){const r=s.findIndex((e=>e.uuid===t));if(!(r>-1))throw`ERROR ! DB.${e}.delete failed. ${t} not found`;s.splice(r,1),a.persist(n),console.log("TAB."+e,"deleted",t.toString())}},update(t,n,s=!1){const o=a.find(t);if(null===o)throw`ERROR ! Table.${e}.update failed. ${t} not found`;return Object.assign(o,n),r.deepassign([o,n]),a.persist(s),console.log("TAB."+e,"updated",s?"force":"",t,r.shrink(n)),o},persist(t){if(t){if(!k.set(e,s))throw`ERROR ! Table.${e}.persist failed`;i=!1}else i=!0}})},E="Boards Games Options Usage".split(" "),S={scheme:"2020-07-09a",Boards:O("Boards"),Games:O("Games"),Options:O("Options"),Usage:O("Usage"),dump:()=>JSON.stringify(S.all(),null,2).replace(/\\"/g,"'"),all:()=>({Scheme:k.get("scheme"),Usage:k.get("Usage"),Options:k.get("Options"),Boards:k.get("Boards"),Games:k.get("Games")}),reset(){console.log("Info   :","Caissa first use, resetting DB...","scheme",S.scheme),k.clear(),k.set("scheme",S.scheme),E.forEach((e=>{S[e]=O(e)}))},persist(){E.forEach((e=>{S[e].persist(!0)})),console.log("DB.persisted",(S.size()/1024).toFixed(2)+" KB")},size(){let e,t,n=0;for(t in localStorage)localStorage.hasOwnProperty(t)&&(e=2*(localStorage[t].length+t.length),n+=e);return n},init(){try{if(k.get("Usage")){S.scheme!==k.get("scheme")&&console.warn("WARN   :","New Scheme detected, please reset DB");const e=S.Usage.first,t=S.Options.first,n=r.msecs2human(Date.now()-e.lastend);e.usage+=1,e.laststart=Date.now(),S.Usage.update("0",{usage:e.usage,laststart:Date.now()}),navigator.storage&&navigator.storage.estimate?Promise.all([navigator.storage.estimate(),navigator.storage.persisted()]).then((([e,t])=>{console.log("Info   :","DB",{quota:e.quota,usage:e.usage,persisted:t})})):console.log("Info   :","DB",{quota:NaN,usage:NaN}),console.log("Info   :","DB",S.scheme,S.Games.length,"games","user:",t.user.name,"usage:",e.usage,"last:",n,"ago")}else S.reset()}catch(e){console.error("DB.init.error",e)}}};let L;S.init();const B={plattform:navigator.platform,userAgent:navigator.userAgent,threads:navigator.hardwareConcurrency||4,vendor:navigator.vendor,touch:"ontouchstart"in document.documentElement,fetch:!!window.fetch,online:!0,languages:navigator.languages.join("|"),vibration:!!window.navigator.vibrate,localStorage:!!window.localStorage,serviceWorker:!!navigator.serviceWorker,storageEstimate:navigator.storage&&navigator.storage.estimate?navigator.storage.estimate:NaN,fullscreen:!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled),wasm:"object"==typeof WebAssembly&&WebAssembly.validate(Uint8Array.of(0,97,115,109,1,0,0,0)),is64bit:function(){const e=["x86_64","x86-64","Win64","x64","amd64","AMD64"];for(const t of e)if(navigator.userAgent.indexOf(t)>=0)return!0;return"Linux x86_64"===navigator.platform||"MacIntel"===navigator.platform||"Linux aarch64"===navigator.platform}(),BigInt:!!window.BigInt,screen:{width:screen.width,height:screen.height,aspect:screen.width/screen.height,availWidth:screen.availWidth,availHeight:screen.availHeight,get innerWidth(){return innerWidth},get innerHeight(){return innerHeight},colorDepth:screen.colorDepth,pixelDepth:screen.pixelDepth,orientation:(screen.orientation||{}).type||screen.mozOrientation||screen.msOrientation,devicePixelRatio:window.devicePixelRatio,"safe-area-inset-top":getComputedStyle(document.documentElement).getPropertyValue("--sat"),"safe-area-inset-right":getComputedStyle(document.documentElement).getPropertyValue("--sar"),"safe-area-inset-bottom":getComputedStyle(document.documentElement).getPropertyValue("--sab"),"safe-area-inset-left":getComputedStyle(document.documentElement).getPropertyValue("--sal")},Atomics:"object"==typeof Atomics,SharedArrayBuffer:"function"==typeof SharedArrayBuffer,OffscreenCanvas:"function"==typeof window.OffscreenCanvas,sharedMemory:function(){try{L=new WebAssembly.Memory({shared:!0,initial:8,maximum:16})}catch(e){return!1}return!0}(),cloning:function(){try{window.postMessage(L,"*")}catch(e){return!1}return!0}(),growable:function(){try{L?.grow(8)}catch(e){return!1}return!0}(),SharedMemory:function(){try{return L?.buffer instanceof SharedArrayBuffer}catch(e){return!1}}(),log(){const e=B;console.log("Info   :","COR"+navigator.hardwareConcurrency,"MEM"+(navigator.deviceMemory?navigator.deviceMemory:"-"),"LS"+(e.localStorage?"+":"-"),"FS"+(e.fullscreen?"+":"-"),"SM"+(e.SharedMemory?"+":"-"),"SAB"+(e.SharedArrayBuffer?"+":"-"),"WASM"+(e.wasm?"+":"-"),"64bit"+(e.is64bit?"+":"-"),"Atoms"+(e.Atomics?"+":"-"),"Clones"+(e.cloning?"+":"-"),"Growables"+(e.growable?"+":"-"),"OSCanvas"+(e.OffscreenCanvas?"+":"-"))}};window.addEventListener("online",(()=>B.online=!0)),window.addEventListener("offline",(()=>B.online=!1)),B.log();const P={view:()=>s()("div.nothing.dn")},D={view({attrs:e,children:t}){const{className:n,style:a,onclick:r}=e;return s()("atom-section-title",{className:n,onclick:r},s()("span",{style:a},t))}},j={view:()=>s()("div.spacer",s().trust("&nbsp;"))},A={view:({attrs:e})=>s()("div.spacer.flex-grow",e,s().trust("&nbsp;"))},W={view:e=>s()("atom-flexlist",e.attrs,e.children)},C={view:e=>s()("div.text-left.tl.fiom.f4.white",s()("span",e.attrs,e.children))},T={view:e=>s()("div.text-center.tc.fiom.f4.white",s()("span",e.attrs,e.children))},M={view:e=>s()("atom-flexlist-text",s()(".fiom",e.attrs,e.children))},R={view:e=>s()("atom-flexlist-entry",e.attrs,s()("div",e.children))},I={view:e=>s()("atom-flexlist-header",s()("h3.cfff.sair",e.children))},_={view:e=>s()("atom-flexlist-menu-entry",e.attrs,e.children)},z={view:e=>s()("atom-scroll-y",e.children)};let G;const H=h.create("Last",{onregister(e){G=e},view:()=>s()("div.last.dn"),onupdate({attrs:{msecs:e}}){setTimeout((()=>G.send({msecs:e})),100)},oncreate({attrs:{msecs:e}}){setTimeout((()=>G.send({msecs:e})),100)}});function q(e,t){return t<2?s()("span.fiob",s().trust(e)):s()("span",s().trust(e))}function U(e,t,n,a,r,o){return s()("div",[q(e,o),t?"[":"{",s()("button",{onclick:()=>a[n]=!1},"+"),t?"] ["+r+"]":"}"])}function F(e,t,n,a,r,o,i,l){var c=[];for(var d in c.push(q(e,l)),c.push(a?"[":"{"),c.push(s()("button",{onclick:()=>o[r]=!0},"-")),t){var p=t[d],u=n.slice();u.push(d),c.push(J(d,p,u,o,i,l+1))}return c.push(a?"]":"}"),s()("div",c)}function J(e,t,n,a,r,o){var i,l,c=null===e?"":e+" : ",d=JSON.stringify(n),p=void 0!==a[d]?a[d]:n.length>r.collapseAfter;return null!==t&&t instanceof Array?(i=t.length,p?U(c,!0,d,a,i,o):F(c,t,n,!0,d,a,r,o)):null!==t&&"object"==typeof t?p?U(c,!1,d,a,0,o):F(c,t,n,!1,d,a,r,o):(l="function"==typeof t?"function":void 0===t?"undefined":JSON.stringify(t).replace(/"/g,"'"),c=e+" :"+Array(Math.max(1,12-(e||"").length)).fill("&nbsp;").join(""),o<2?s()("div.fiob",s().trust(c),s()("div.dib.fior.ma0",l)):s()("div",s().trust(c+l)))}const $=function(){const e={};return{view:function(t){const{tree:n,options:a}=t.attrs;return J(null,n,[],e,a,0)}}};var V=n(789),K=n(874),Y=n(12),Q=n(378),X=n(566);V.As.addStyle(".atom-button",{color_light_background:"#688799",color_light_text:"#fff",border_radius:11,label_padding_v:5});const Z={view:e=>s()("atom-form-button",s()(K.z,Object.assign({className:"atom-button",raised:!0,wash:!0},e.attrs)))},ee={view:e=>s()(K.z,Object.assign({className:"atom-button",raised:!0,wash:!0},e.attrs))};V.OC.addStyle(".atom-checkbox",{color_light_on:"#eee",color_light_off:"#eee",color_light_label:"#333"});const te={view:e=>s()("atom-form-checkbox.fior",s()(Y.X,{...e.attrs,className:"atom-checkbox",raised:!0}))};V.dn.addStyle(".atom-textfield",{color_light_input_background:"white",color_light_input_text:"#333",color_light_background:"#688799"});const ne={view:e=>s()("atom-form-textfield.fior",s()(Q.n,{...e.attrs,className:"atom-textfield",floatingLabel:!0}))},ae={view:e=>s()("atom-form-note",s()(".fior",e.attrs.label))},se={view:e=>s()("atom-form-header",s()("h3.cfff.sair",e.attrs.label))},re={view:e=>s()("atom-form-list",e.attrs,e.children)},oe=h.create("Help",{view:e=>s()("div.page.help",e.attrs,s()(D,"Help"),s()(j))}),ie=(e,t)=>n=>{n.redraw=!1,at.route(e,t)},le=h.create("Menu",{view(e){const{className:t,style:n}=e.attrs;return s()("div.page.menu",{className:t,style:n},s()(D,"Menu"),s()(j),s()(W,m.map((([e,t,n,a])=>s()(_,{onclick:ie(e,n)},[s()(C,[a.img?s()("img.menu",{src:a.img,width:22,height:22}):s()("i.menu.fa."+a.ifa),t,s()("div.menu.subline",a.subline)])])))))}}),ce=h.create("Preferences",{view(e){const t=Object.keys(S.Options.first);return s()("div.page.options",e.attrs,[s()(D,"Preferences"),s()("div.viewport-y",[...t.map((e=>{const t={group:e,autosubmit:!0,...S.Options.first[e],submit:()=>{delete t.group,delete t.submit,delete t.autosubmit,S.Options.update("0",{[e]:t},!0)}}}))]),s()("div.mv1.ph3.w-100.tc.pv2",s()("button.w-80.pv1",{style:"border-radius: 15px",onclick:()=>S.reset()},"Defaults"))])}});let de="";const pe={view:({attrs:{tree:e}})=>s()("div.w-100.viewport-y.h-100.bg-ccc",[s()("div.fior.pv2",{class:"json-tree"},[s()($,{tree:e,options:{collapseAfter:1}})])])},ue={view:()=>s()(W,[s()("system-filter",s()("input[type=text].w-100.bg-eee.ph2.pv1",{style:"border: 0",oninput:e=>de=e.target?.value+"",value:de,placeholder:"type to filter"})),s()("pre.pl3.viewport-xy.f7.bg-ccc.h-100.pt2",[s().trust(y.search(de).slice(0,1e3).join("<br/>"))])])},me=h.create("System",{view(e){const{params:{module:t},className:n,style:a}=e.attrs,r="config"===t?s()(pe,{tree:u}):"system"===t?s()(pe,{tree:B}):"db"===t?s()(pe,{tree:S.all()}):s()(ue),o=e=>t=>{t.redraw=!1,at.route("/system/:module/",{module:e},{replace:!1})};return s()("div.page.system",{className:n,style:a},[s()("div.systemmenu.w-100.btb20",[s()("ul.flex.flex-row.ml2.white","System Config DB Logs".split(" ").map((e=>s()("li.ph2.pv1.f4.list.pointer",{onclick:o(e.toLowerCase())},e))))]),r])}}),ge=h.create("Error",{view:e=>s()("div.page.error",e.attrs,[s()(D,"Error"),s()(W,[s()(j),s()(T,JSON.stringify(e.attrs)),s()(A)])])}),fe=h.create("Nothing",{view(e){const{className:t}=e.attrs;return s()("div.page.nothing",{className:t},s()(D,"Nothing"),s()(j))}}),he={},ve=[];let be=NaN;const we={back:!1,fore:!1,same:!1,replace:!1,redraw:!1,popstate:!1,hashchange:!1,noanimation:!1},ye={stack:ve,get pointer(){return be},log(){ve.forEach(((e,t)=>{t===be?console.log("HIST."+t,[e.key,e.page.name||"",r.shrink(e.params)]):console.log("hist."+t,[e.key,e.page.name,r.shrink(e.params)])}))},isCurrent:e=>!(!ve[be]||ve[be].key!==e),get current(){return ve.length?ve[be].key:""},get canBack(){return!isNaN(ye.pointer)&&ye.pointer>0},get canFore(){return!isNaN(ye.pointer)&&ye.pointer<ye.stack.length-1},goback(){const{route:e,params:t}=ve[be-1];at.route(e,t,{back:!0,noanimation:!0})},gofore(){const{route:e,params:t}=ve[be+1];at.route(e,t,{fore:!0,noanimation:!0})},onback(e){e.redraw=!1;const{route:t,params:n}=ve[be-1];return at.route(t,n,{back:!0}),r.eat(e)},onfore(e){e.redraw=!1;const{route:t,params:n}=ve[be+1];return at.route(t,n,{fore:!0}),r.eat(e)},onhashchange:e=>(we.hashchange=!0,r.eat(e)),onpopstate:e=>(we.popstate=!0,r.eat(e)),recent:e=>ve.map((e=>e.page)).slice(-e),prepare(e,t={},n={replace:!1}){const a=s().buildPathname(e,t),o={key:a,route:e,params:t,...n,page:fe};if(isNaN(be))he[a]=o;else if(he[a]);else if(ve[be]&&ve[be].key===a)we.same=!0;else if(n.redraw)we.redraw=!0;else if(n.replace||we.replace)he[a]=o,we.replace=!0,r.shrink(n);else if(n.back||we.back)we.back=!0,void 0!==n.noanimation&&(we.noanimation=!!n.noanimation);else if(n.fore||we.fore)we.fore=!0,void 0!==n.noanimation&&(we.noanimation=!!n.noanimation);else if(we.hashchange||we.popstate)if(we.hashchange&&ve[be-1]&&ve[be-1].key===a)we.back=!0;else if(we.hashchange&&ve[be+1]&&ve[be+1].key===a)we.fore=!0;else if(!we.hashchange&&we.popstate)we.same=!0;else for(he[a]=o;ve.length;)ve.pop();else he[a]=o},finalize(e,t,n){const a=s().buildPathname(e,t);if(we.replace&&he[a])ve[be].key=a,ve[be].params=t,delete he[a];else if(we.redraw);else if(we.same||ve[be]&&ve[be].key===a)we.same=!0;else if(we.back)be-=1;else if(we.fore)be+=1;else if(he[a]){for(;be<ve.length-1;)ve.pop();be=ve.push(r.create({key:a,route:e,params:t,page:n}))-1,delete he[a]}},get animation(){return 1===ve.length?"=1=":we.replace?"=r=":we.redraw?"=w=":we.same?"=s=":we.back&&we.noanimation?"=b=":we.back&&!we.noanimation?"=b>":we.fore&&we.noanimation?"=f=":we.fore&&!we.noanimation?"<f=":"<c="},slides(){const e={anim:"",names:[],entries:[]},t={key:"",page:fe,route:"",params:{}};function n(n){[0,1,2].forEach((a=>{const s=be+n+a,r=ve[s]?ve[s]:t;e.names.push(r.page.name),e.entries.push(r)}))}return 1===ve.length?(n(-1),e.anim="=1="):we.replace?(n(-1),e.anim="=r="):we.redraw?(n(-1),e.anim="=w="):we.same?(n(-1),e.anim="=s="):we.back?(n(0),e.anim=we.noanimation?"=b=":"=b>"):we.fore?(n(-2),e.anim=we.noanimation?"=f=":"<f="):(n(-2),e.anim="<c="),r.clear(he),we.replace=!1,we.back=!1,we.fore=!1,we.same=!1,we.redraw=!1,we.popstate=!1,we.hashchange=!1,we.noanimation=!1,e}};let ke,xe=0;const Ne={listen(){window.addEventListener("load",at.onload),window.addEventListener("unload",Ne.onunload),window.addEventListener("beforeunload",Ne.onbeforeunload),window.addEventListener("online",Ne.ononline),window.addEventListener("offline",Ne.onoffline),window.addEventListener("resize",Ne.onresize),window.addEventListener("popstate",ye.onpopstate),window.addEventListener("hashchange",ye.onhashchange),document.addEventListener("selectionchange",Ne.onselectionchange),document.addEventListener("dblclick",r.eat)},onresize(){const e=innerWidth>innerHeight?"landscape":"portrait";(xe<=360&&innerWidth>360||xe>360&&innerWidth<=360||xe>720&&innerWidth<=720||xe<=720&&innerWidth>720||ke!==e)&&at.redraw(),xe=innerWidth,ke=e},ononline(){B.online=!0},onoffline(){B.online=!1},onbeforeunload(e){console.log("onbeforeunload",e)},onunload(){S.Usage.update("0",{lastend:Date.now()}),S.persist(),console.log("Bye...")},onselectionchange(){},onkeydown(e){const t=Ne.keymap();e.code in t?(console.log("Events.onkeydown.found",e.code),e.redraw=!1,t[e.code]()):console.log("Events.onkeydown.unknown",e.code)},keymap:()=>({})},Oe=Math.abs;let Ee,Se,Le,Be=innerWidth/3,Pe={selektor:"",time:NaN,down:{x:NaN,y:NaN},diff:{x:NaN,y:NaN}},De="transitionend";const je={listen(){B.touch&&(document.addEventListener("touchstart",je.down,!1),document.addEventListener("touchmove",je.move,!1),document.addEventListener("touchend",je.end,!1))},remove(){document.removeEventListener("touchstart",je.down,!1),document.removeEventListener("touchmove",je.move,!1),document.removeEventListener("touchend",je.end,!1)},pause(){Pe.selektor=""},init(e){setTimeout((()=>{Ee=o("div.slide.left"),Se=o("div.slide.right"),Pe.selektor="div.slide.center",Le=e,Be=innerWidth/4}))},down(e){Pe.selektor&&e.target.closest(Pe.selektor)&&(Pe.time=Date.now(),Pe.down.x=e.touches[0].clientX,Pe.down.y=e.touches[0].clientY,Pe.diff.x=0,Pe.diff.y=0)},onafterback(){Ee?.removeEventListener(De,je.onafterback),ye.goback()},onafterfore(){Se?.removeEventListener(De,je.onafterfore),ye.gofore()},move(e){if(Pe.down.x||Pe.down.y){const t=e.touches[0].clientX,n=e.touches[0].clientY;Pe.diff.x=Pe.down.x-t,Pe.diff.y=Pe.down.y-n,Oe(Pe.diff.x)>3*Oe(Pe.diff.y)&&(Ee&&ye.canBack&&Pe.diff.x<0&&(Oe(Pe.diff.x)>Be?(Ee.addEventListener(De,je.onafterback),Ee.classList.add("page-slide","trans-center")):Ee.style.transform="translateX("+Oe(Pe.diff.x)+"px)"),Se&&ye.canFore&&Pe.diff.x>0&&(Oe(Pe.diff.x)>Be?(Se.addEventListener(De,je.onafterfore),Se.classList.add("page-slide","trans-center")):Se.style.transform="translateX("+(2*Le-Oe(Pe.diff.x))+"px)"))}},end(){Pe.selektor&&(Pe.down={x:NaN,y:NaN},Pe.diff={x:NaN,y:NaN},Ee&&(Ee.addEventListener(De,(function e(){Ee?.removeEventListener(De,e),Ee?.classList.remove("page-slide")})),Ee.classList.add("trans-left","page-slide")),Se&&(Se.addEventListener(De,(function e(){Se?.removeEventListener(De,e),Se?.classList.remove("page-slide")})),Se.classList.add("trans-right","page-slide")))}};let Ae=null;const We={show(e){o("back-drop").classList.add("visible"),Ae=e||null},hide(){o("back-drop").classList.remove("visible")},view(e){const{callback:t}=e.attrs;return s()("back-drop",{onclick:e=>{e.redraw=!1,We.hide(),t&&t()}})}};let Ce,Te,Me="transitionend";const Re={oninit(){je.listen()},onbeforeupdate(){je.pause()},onremove(){je.remove()},onresize(e){Te=e<=360?e:360},view(){const e={},t=ye.slides(),[n,a,r]=t.entries;return Ce=t.anim,t.entries.forEach((e=>{})),s()(".pages",[s()(n.page,{route:n.route,params:n.params,style:e,className:"slide left trans-left"}),s()(a.page,{route:a.route,params:a.params,style:e,className:"slide center trans-center"}),s()(r.page,{route:r.route,params:r.params,style:e,className:"slide right trans-right"}),s().fragment({oncreate:()=>setTimeout(Ie,100),onupdate:()=>setTimeout(Ie,100)},[s()("div.dn")])])}};function Ie(){const e=o("div.slide.left"),t=o("div.slide.center"),n=o("div.slide.right");"=1="===Ce||"=r="===Ce||"=s="===Ce||"=w="===Ce?((ye.canBack||ye.canFore)&&je.init(Te),e?.classList.contains("trans-center")&&(e.classList.add("trans-left"),e.classList.remove("trans-center")),n?.classList.contains("trans-center")&&(n.classList.add("trans-right"),n.classList.remove("trans-center"))):"=b>"===Ce?(e?.addEventListener(Me,_e),e?.classList.remove("trans-left"),e?.classList.add("page-slide","trans-center"),t?.classList.remove("trans-center"),t?.classList.add("page-slide","trans-right")):"<c="===Ce||"<f="===Ce?(n?.addEventListener(Me,_e),n?.classList.remove("trans-right"),n?.classList.add("page-slide","trans-center"),t?.classList.remove("trans-center"),t?.classList.add("page-slide","trans-left")):"=b="===Ce||"=f="===Ce?at.redraw():console.warn("pages.onafterupdates.unknown anim",Ce)}function _e(){const e=o("div.slide.left"),t=o("div.slide.center"),n=o("div.slide.right");e?.classList.remove("page-slide","trans-right","trans-center"),e?.classList.add("trans-left"),n?.removeEventListener(Me,_e),n?.classList.remove("page-slide","trans-right","trans-left"),n?.classList.add("trans-center"),t?.classList.remove("page-slide","trans-left","trans-right"),t?.classList.add("trans-center"),Ce="",at.redraw()}var ze=n(329);const Ge={view(e){const t=(e,t)=>n=>(n.redraw=!1,We.hide(),o("#toggle-mobile-menu").checked=!1,at.route(e,t),r.eat(n));return s()("nav",[s()("label",{"aria-label":"Menu",onclick:e=>{e.redraw=!1,at.route("/menu/")}},s()("i.hamburger.fa.fa-bars "),s()("span.home.f4.fiom.white.pl3","Caissa")),s()("input[type=checkbox]",{id:"toggle-mobile-menu",oninput:e=>{e.redraw=!1,e.target.checked&&We.show((()=>{o("#toggle-mobile-menu").checked=!1}))}}),s()("ul",Array.from(m).map((([e,n,a])=>s()("li",{onclick:t(e,a),class:e.startsWith("navi")?"selected":"unselected"},n))))])}},He={view({attrs:{route:e,params:t}}){const n=innerWidth>=720?"360px":"100vw";return s()("header.w-100",s()("div.controls.flex",{style:"width:"+n},[s()(Ge,{route:e,params:t}),ye.canBack?s()("i.navi.fa.fa-angle-left",{onclick:ye.onback}):s()("i.navi.fa.fa-angle-left.ctrans"),ye.canFore?s()("i.navi.fa.fa-angle-right",{onclick:ye.onfore}):s()("i.navi.fa.fa-angle-right.ctrans"),s()("i.navi.fa.fa-retweet",{onclick:e=>{e.redraw=!1,window.location.reload()}}),s()("i.navi.fa.fa-expand-arrows-alt",{onclick:e=>{e.redraw=!1,B.fullscreen&&ze.Z.toggle()}})]))}},qe={view(e){const{className:t,style:n}=e.attrs;return s()("cell-aside",{className:t,style:n},[s()(D,{className:"",style:"",onclick:()=>{}},"Analyzer")])}},Ue={view(e){const{className:t,style:n}=e.attrs;return s()("cell-footer",{className:t,style:n},"FOOTER")}},Fe=n.p+"assets/pictures/opera.game.small.gif";var Je=n(830),$e=n.n(Je);const Ve={button:Z,submit:Z,textfield:ne,checkbox:te,note:ae,header:se};function Ke(e){const t={};return Object.entries(e).forEach((([e,n])=>{t[e]=n()})),t}const Ye={oninit(e){Object.assign(e.state,function(e){const t={};return Object.entries(e).forEach((([e,n])=>{t[e]=$e()(n)})),t}(e.attrs.values))},view(e){const t=e.state,{fields:n,onsubmit:a,onchange:r=(()=>{}),className:o="",style:i=""}=e.attrs,l=()=>a(Ke(t)),c=()=>r(Ke(t));return s()("cell-form",{className:o,style:i},[s()(re,{className:o,style:i},[n.map((e=>function(e,t,n,a){return"button"===e.type||"submit"===e.type?s()(Ve[e.type],{label:e.label,events:{onclick:"submit"===e.type?a:n}}):"textfield"===e.type?s()(Ve[e.type],{label:e.label,help:e.help,onChange:e=>t(e.value),value:t()}):"checkbox"===e.type?s()(Ve[e.type],{label:e.label,checked:t(),onChange:e=>t(e.checked)}):"note"===e.type||"header"===e.type?s()(Ve[e.type],{label:e.label}):s()("div",JSON.stringify(e))}(e,t[e.name],c,l)))])])}},Qe={view(e){const{className:t,style:n}=e.attrs,a=`${i.name} / ${i.version} / ${S.scheme}`,r={showsplash:!S.Options.first.ui.waitscreen,username:S.Options.first.user.name};return s()("cell-splash",{className:t,style:n},[s()(D,{className:"",style:"",onclick:()=>{}},"Welcome"),s()(I,`${i.name} - ${i.description}`),s()(z,[s()(W,[s()(Ye,{onsubmit:e=>{S.Options.update("0",{ui:{waitscreen:!e.showsplash},user:{name:e.username}},!0)},onchange:e=>{console.log("splash.change",e)},values:r,fields:[{name:"username",type:"textfield",label:"Please provide a user name"},{name:"showsplash",type:"checkbox",label:"Do not how again"},{name:"submit",type:"submit",label:"Start"}]}),s()(R,{style:"padding: 0"},s()("img",{src:Fe,alt:"The Opera Game",title:"The Opera Game",width:"100%"})),s()(M,"Morphy - Brunswick, Isoard, Paris 02.11.1858"),s()(R,s()(X.h,[s()(ee,{label:"Reload",events:{onclick:()=>location.reload()}}),s()(ee,{label:"Reset",events:{onclick:S.reset}}),s()(ee,{label:"DB.dump()",events:{onclick:at.dumpDB}})]))])]),s()(M,{style:"font-size: 12px; color: #666"},a)])}},Xe={view(e){const{center:t,page:n,route:a,params:r}=e.attrs,o=S.Options.first.ui.waitscreen;return s()("cell-layout",o?[s()(We),s()(Qe),s()(H,{msecs:Date.now()})]:[s()(We),s()(He,{route:a,params:r}),s()("main",[s()("section.stage",{},s()(Re)),s()("section.content",{},innerWidth>=720?s()(t):s()(P)),s()("section.aside",{},innerWidth>=720?s()(qe):s()(P))]),s()(Ue),s()(H,{msecs:Date.now()})])}},Ze={view(e){const{className:t,style:n}=e.attrs;return s()("cell-toolbar",{className:t,style:n},"TOOLBAR")}},et={view(e){const{className:t,style:n}=e.attrs;return s()("div",{style:"width: 100%; flex: 0 0;"},[s()("div",{style:"padding-bottom: 100%; width: 0; float: left"}),s()("cell-chessboard",{className:t,style:n},"CHESSBOARD")])}},tt={view(e){const{className:t,style:n}=e.attrs;return s()("cell-content",[s()(D,{className:"",style:"",onclick:()=>{}},"Content"),s()(Ze,{className:"",style:""}),s()(Ze,{className:"",style:""}),s()(et,{className:"",style:""}),s()(Ze,{className:"",style:""}),s()(Ze,{className:"",style:""})])}},nt={"/":[Xe,le,tt,{title:"Menu 1"}],"/menu/":[Xe,le,tt,{title:"Menu 2"}],"/preferences/":[Xe,ce,tt,{title:"Preferences"}],"/nothing/":[Xe,fe,P,{title:"Help"}],"/help/":[Xe,oe,P,{title:"Help"}],"/system/":[Xe,me,P,{title:"System"}],"/system/:module/":[Xe,me,P,{title:"System %s"}],"/:404...":[Xe,ge,P,{title:"Error %s"}]},at={H:r,DB:S,System:B,Env:"",reset(){S.reset(),at.route("/menu/"),location.reload()},dumpDB(){const e=JSON.stringify({DB:S.all(),SYSTEM:B,CONFIG:u,OPTIONS:g},null,2).replace(/\\"/g,"'"),t=document.body;t.style.whiteSpace="pre",t.style.background="white",t.style.overflow="auto",t.style.color="black",t.style.fontFamily="monospace",document.body.innerText=e},start(e){y.log("caissa","onafterImport"),Ne.listen()},onload(){y.log("caissa","onload");const e=Date.now()-window.t0;e>2e3?console.warn("Warn   :","... done after",e,"msecs","\n"):console.log("Info   :","... done after",e,"msecs","\n"),window.onerror=function(){console.warn("Error :",arguments)},window.onunhandledrejection=function(e){e.preventDefault(),console.warn("Error :",e.type,e.reason,e)},Ne.listen(),console.log(" ")},redraw(e){e&&(e.redraw=!1),ye.prepare("",{},{redraw:!0}),s().redraw()},route(e,t={},n={replace:!1}){const a=nt[e];a?(ye.prepare(e,t,n),s().route.set(e,t,{title:a[3].title,...n})):console.error("caissa.route.error",e,t,n)},resolver(e,t){const n=t[1];return{onmatch(t){try{ye.prepare(e,t)}catch(e){console.log(JSON.stringify(e),e)}},render:t=>(ye.finalize(e,t.attrs,n),s()(at.comp,{route:e,params:t.attrs}))}},comp:{view(e){const{route:t,params:n}=e.attrs,[a,r,o,i]=nt[t];return document.title=i.title,s()(a,{route:t,params:n,page:r,center:o})}}};try{const e=document.body.querySelector("app-root"),t=r.transform(nt,at.resolver);s().route.prefix="#!",s().route(e,"/menu/",t),window.App=at,window.onload=at.onload}catch(e){console.error("index.js",e)}console.log("Info   :","index.js loaded after",Date.now()-window.t0,"msecs")}},e=>{e.O(0,[736,215],(()=>(558,e(e.s=558)))),e.O()}]);